# `tonyfettes/tree_sitter`

This is a MoonBit binding to the
[tree-sitter](https://tree-sitter.github.io/tree-sitter/index.html) incremental
parsing library.

## Quickstart

1. Add this module as a dependency to your MoonBit project:

   ```bash
   moon update # Update the mooncakes.io package index
   moon add tonyfettes/tree_sitter
   ```

2. Import the `tonyfettes/tree_sitter` package in `moon.pkg.json`:

   ```json
   {
     "import": [
       "tonyfettes/tree_sitter"
     ]
   }
   ```

3. Optionally you may want to install MoonBit bindings to the tree-sitter
   grammars you want to use. For example, to install the `tree-sitter-moonbit`
   grammar:

   ```bash
   moon add tonyfettes/tree_sitter_moonbit
   ```

   And then import the `tonyfettes/tree_sitter_moonbit` package in your
   `moon.pkg.json` file as well:

    ```json
    {
      "import": [
        "tonyfettes/tree_sitter",
        "tonyfettes/tree_sitter_moonbit"
      ]
    }
    ```

4. Use the `tonyfettes/tree_sitter` API to parse your code:

   ```moonbit
   ///|
   fn main {
     let moonbit = @tree_sitter_moonbit.language()
     let parser = @tree_sitter.Parser::new()
     parser.set_language(moonbit)
     let source_code =
       #|fn main {
       #|  println("Hello, World!")
       #|}
     let tree = parser.parse_string(None, source_code)
     let root_node = tree.root_node()
     println(root_node.string())
   }
   ```

## API walkthrough

The [Tree-sitter User Guide](https://tree-sitter.github.io/tree-sitter/) is a
good place to start if you're new to tree-sitter. Although the API is written in
C, this MoonBit binding is just a thin wrapper around the C API, so the
documentation should be mostly applicable.

This binding is at its very early stages, so many APIs are not yet implemented.
If you find a missing API that you need, please open an issue or a pull request.

Apart from the standard tree-sitter API, this binding also provides
abilities to parse the `grammar.json` and `node-types.json` files that are
generated by the tree-sitter CLI. This is useful if you want to generate
MoonBit type definitions for a tree-sitter grammar.
